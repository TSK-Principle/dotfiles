# --- åŸºç¡€è®¾ç½® ---
set -g status-style bg=default 
set -g base-index 1
setw -g pane-base-index 1
setw -g mode-keys vi

# è™½ç„¶æˆ‘ä»¬ä¸»è¦ç”¨ Alt é”®ï¼Œä½†ä¿ç•™ä¸€ä¸ª Prefix ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ (å¦‚åµŒå¥— tmux æ—¶)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# --- æ ¸å¿ƒï¼šåŽ»å‰ç¼€åŒ–ç»‘å®š (ä½¿ç”¨ -n å‚æ•°) ---
# æ³¨æ„ï¼šM ä»£è¡¨ Alt é”® (Meta)

# 1. çª—å£åˆ†å‰² (Split) -> Alt + \ å’Œ Alt + -
unbind %
unbind '"'
bind -n M-\\ split-window -h -c "#{pane_current_path}"
bind -n M-- split-window -v -c "#{pane_current_path}"

bind -n M-Space select-pane -t :.+

# 3. é¢æ¿è°ƒæ•´å¤§å° (Resize) -> Alt + Shift + æ–¹å‘é”® (ä¿æŒä½ åŽŸæœ‰çš„è®¾ç½®)
bind -n M-S-Left resize-pane -L 5
bind -n M-S-Right resize-pane -R 5
bind -n M-S-Up resize-pane -U 5
bind -n M-S-Down resize-pane -D 5

# 4. å¤åˆ¶æ¨¡å¼ä¸Žç²˜è´´ (Copy Mode)
# å»ºè®®ï¼šä½¿ç”¨ Alt + v è¿›å…¥å¤åˆ¶æ¨¡å¼ï¼ŒAlt + p ç²˜è´´
bind -n M-v copy-mode
bind -n M-p paste-buffer

# å¤åˆ¶æ¨¡å¼å†…éƒ¨çš„æŒ‰é”® (Copy Mode VI key table)
# è¿™äº›æ˜¯åœ¨è¿›å…¥å¤åˆ¶æ¨¡å¼åŽä½¿ç”¨çš„ï¼Œä¸éœ€è¦ -n
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -i && tmux display-message 'Content copied to clipboard!'"
# æ·»åŠ  Esc é€€å‡ºå¤åˆ¶æ¨¡å¼ (ä¹ æƒ¯æ€§è®¾ç½®)
bind-key -T copy-mode-vi Escape send-keys -X cancel

# 5. çª—å£ç®¡ç† (Window Management)
# é‡å‘½å -> Alt + r
bind -n M-r command-prompt -I "#W" "rename-window '%%'"

# æ–°å¢žå»ºè®®ï¼šåˆ›å»ºæ–°çª—å£ -> Alt + c (éžå¸¸å¸¸ç”¨)
bind -n M-c new-window -c "#{pane_current_path}"

# æ–°å¢žå»ºè®®ï¼šå…³é—­å½“å‰é¢æ¿/çª—å£ -> Alt + x (æ¯”é»˜è®¤çš„ prefix + x æ›´å¿«)
bind -n M-x kill-pane

# --- è¡¥å……çš„é«˜é¢‘æ“ä½œ (å…¨éƒ¨åŽ»å‰ç¼€) ---

# 1. æœ€å¤§åŒ–/æ¢å¤å½“å‰é¢æ¿ (Zoom) -> Alt + z
# è¿™ä¸ªåŠŸèƒ½è¶…çº§å¸¸ç”¨ï¼šæš‚æ—¶æŠŠä¸€ä¸ªå°çª—å£å…¨å±ï¼Œçœ‹å®Œå†æŒ‰ä¸€æ¬¡æ¢å¤
bind -n M-z resize-pane -Z

# 2. ä¼šè¯é€‰æ‹©å™¨ (Session Switcher) -> Alt + s
# è¿˜åœ¨ç”¨ Prefix + s å—ï¼Ÿæ”¹æˆ Alt + s çž¬é—´åˆ—å‡ºæ‰€æœ‰é¡¹ç›®
bind -n M-s choose-session

# 3. å¿«é€Ÿé‡è½½é…ç½®æ–‡ä»¶ -> Alt + R (Shift + r)
# æ”¹å®Œé…ç½®ä¸ç”¨é‡å¯ tmuxï¼ŒæŒ‰ä¸€ä¸‹ç«‹åˆ»ç”Ÿæ•ˆ
bind -n M-R source-file ~/.config/tmux/tmux.conf \; display "Config Reloaded!"

# 6. çª—å£åˆ‡æ¢ (Switch Window) -> Alt + æ•°å­— (ä¿æŒä½ åŽŸæœ‰çš„è®¾ç½®)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9
bind -n M-0 select-window -t 10

bind -n M-/ display-popup -E -w 60% -h 60% -T " âœ‚ï¸  Quick Snippets " "bash -c 'cat $HOME/dotfiles/docs/prompt.txt | fzf --reverse --border=none --prompt=\"Copy > \" | tr -d \"\\n\" | tmux load-buffer -w -'"

bind -n M-m run-shell -b "killall mpv >/dev/null 2>&1 || true; mpv --no-video --shuffle ~/Music >/dev/null 2>&1 & tmux display-message 'ðŸŽµ Playing Music'; true"
bind -n M-. run-shell -b "killall mpv >/dev/null 2>&1 && tmux display-message 'ðŸ›‘ Music Stopped'; true"

bind -n C-o run-shell "tmux display-popup -E 'cat ~/dotfiles/docs/commands.txt | fzf --reverse | tmux load-buffer - && tmux paste-buffer -d -t #{pane_id}'"
